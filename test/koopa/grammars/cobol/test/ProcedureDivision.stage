package koopa.grammars.cobol.test;
grammar koopa.grammars.cobol.CobolGrammar;

target statement;

+[ DISPLAY FIELD ]

-[ TRANSMOGRIFY ]


target sentence;

+[ . ]

+[ DISPLAY FIELD . ]

+[ ADD A TO B . ]

+[ ADD A TO B
   DISPLAY B . ]


target paragraph;

+[ PARAGRAPH-07 . ]

+[ PARAGRAPH-08 .
   ADD A TO B . ]

+[ PARAGRAPH-09 .
   ADD A TO B .
   DISPLAY B . ]

+[ PARAGRAPH-09 .
   ADD A TO B
   DISPLAY B . ]

+[ 10 . ]

+[ 11 .
   ADD A TO B . ]

+[ 12 .
   ADD A TO B .
   DISPLAY B . ]

+[ 13 .
   ADD A TO B
   DISPLAY B . ]


target section;

+[ SECTION-10 SECTION . ]

+[ 10 SECTION . ]

+[ SECTION-11 SECTION .
   ADD A TO B . ]

+[ 11 SECTION .
   ADD A TO B . ]

+[ SECTION-12 SECTION .
   ADD A TO B .
   DISPLAY B . ]

+[ 12 SECTION .
   ADD A TO B .
   DISPLAY B . ]

+[ SECTION-12 SECTION .
   ADD A TO B
   DISPLAY B . ]

+[ 12 SECTION .
   ADD A TO B
   DISPLAY B . ]

+[ SECTION-13 SECTION .
   PARAGRAPH-13 .
   DISPLAY 13 . ]

+[ 13 SECTION .
   PARAGRAPH-13 .
   DISPLAY 13 . ]

+[ 13 SECTION .
   14 .
   DISPLAY 13 . ]

+[ SECTION-14 SECTION .
   ADD A TO B .
   PARAGRAPH-14 .
   DISPLAY 14 . ]

+[ SECTION-15 SECTION .
   ADD A TO B .
   PARAGRAPH-15-A .
   DISPLAY 15A .
   PARAGRAPH-15-B .
   DISPLAY 15B . ]
   

target declarativeSection;

+[ INPUT-ERROR SECTION .
     USE AFTER ERROR PROCEDURE ON MASTER-FILE . 
]

+[ INPUT-ERROR SECTION .
     USE AFTER ERROR PROCEDURE ON MASTER-FILE . 
     DISPLAY "Input error " . 
]

+[ INPUT-ERROR SECTION .
     USE AFTER ERROR PROCEDURE ON MASTER-FILE . 
   REPORT-ERROR . 
     DISPLAY "Input error " . 
]


target declaratives;

+[ DECLARATIVES .
   INPUT-ERROR SECTION .
     USE AFTER ERROR PROCEDURE ON MASTER-FILE . 
   REPORT-ERROR . 
     DISPLAY "Input error " . 
   END DECLARATIVES .
]

+[ DECLARATIVES .
   END DECLARATIVES .
]


target usingOrChainingPhrase;

+[ USING BY REFERENCE A ]
+[ USING REFERENCE A ]
+[ USING A ]
+[ USING BY VALUE A ]
+[ USING VALUE A ]

+[ CHAINING BY REFERENCE A ]
+[ CHAINING REFERENCE A ]
+[ CHAINING A ]
+[ CHAINING BY VALUE A ]
+[ CHAINING VALUE A ]


target procedureDivision;

+[ PROCEDURE DIVISION . ]

+[ PROCEDURE DIVISION USING DATA-AREA . ]
+[ PROCEDURE DIVISION USING DATA-AREA-A DATA-AREA-B DATA-AREA-C . ]

+[ PROCEDURE DIVISION CHAINING DATA-AREA . ]
+[ PROCEDURE DIVISION CHAINING DATA-AREA-A DATA-AREA-B DATA-AREA-C . ]

-[ PROCEDURE DIVISION USING DATA-AREA-A CHAINING DATA-AREA-B . ]
-[ PROCEDURE DIVISION CHAINING DATA-AREA-A USING DATA-AREA-B . ]

+[ PROCEDURE DIVISION .
   DISPLAY 18 . ]

+[ PROCEDURE DIVISION .
   DECLARATIVES .
   OUTPUT-ERROR SECTION .
     USE AFTER ERROR PROCEDURE ON OUTPUT .
   REPORT-ERROR .
     DISPLAY "Output error." .
   END DECLARATIVES .
   DISPLAY 19 . ]

+[ PROCEDURE DIVISION .
   PARAGRAPH-20 .
   DISPLAY 20 . ]

+[ PROCEDURE DIVISION .
   DECLARATIVES .
   OUTPUT-ERROR SECTION .
     USE AFTER ERROR PROCEDURE ON OUTPUT .
   REPORT-ERROR .
     DISPLAY "Output error." .
   END DECLARATIVES .
   PARAGRAPH-21 .
   DISPLAY 21 . ]

+[ PROCEDURE DIVISION .
   DISPLAY 22A .
   PARAGRAPH-22 .
   DISPLAY 22B . ]

+[ PROCEDURE DIVISION .
   DECLARATIVES .
   OUTPUT-ERROR SECTION .
     USE AFTER ERROR PROCEDURE ON OUTPUT .
   REPORT-ERROR .
     DISPLAY "Output error." .
   END DECLARATIVES .
   DISPLAY 23A .
   PARAGRAPH-23 .
   DISPLAY 23B . ]

+[ PROCEDURE DIVISION .
   SECTION-24 SECTION .
   DISPLAY 24 . ]

+[ PROCEDURE DIVISION .
   DECLARATIVES .
   OUTPUT-ERROR SECTION .
     USE AFTER ERROR PROCEDURE ON OUTPUT .
   REPORT-ERROR .
     DISPLAY "Output error." .
   END DECLARATIVES .
   SECTION-25 SECTION .
   DISPLAY 25 . ]

+[ PROCEDURE DIVISION .
   DISPLAY 26A .
   SECTION-26 SECTION .
   DISPLAY 26B . ]

+[ PROCEDURE DIVISION .
   DECLARATIVES .
   OUTPUT-ERROR SECTION .
     USE AFTER ERROR PROCEDURE ON OUTPUT .
   REPORT-ERROR .
     DISPLAY "Output error." .
   END DECLARATIVES .
   DISPLAY 27A .
   SECTION-27 SECTION .
   DISPLAY 27B . ]

+[ PROCEDURE DIVISION .
   DISPLAY 28A .
   SECTION-28 SECTION .
   DISPLAY 28B .
   PARAGRAPH-28 .
   DISPLAY 28C . ]

+[ PROCEDURE DIVISION .
   DECLARATIVES .
   OUTPUT-ERROR SECTION .
     USE AFTER ERROR PROCEDURE ON OUTPUT .
   REPORT-ERROR .
     DISPLAY "Output error." .
   END DECLARATIVES .
   DISPLAY 29A .
   SECTION-29 SECTION .
   DISPLAY 29B .
   PARAGRAPH-29 .
   DISPLAY 29C . ]

+[ PROCEDURE DIVISION .
   DISPLAY 30A .
   PARAGRAPH-30 .
   DISPLAY 30B .
   SECTION-30 SECTION .
   DISPLAY 30C . ]

+[ PROCEDURE DIVISION .
   DECLARATIVES .
   OUTPUT-ERROR SECTION .
     USE AFTER ERROR PROCEDURE ON OUTPUT .
   REPORT-ERROR .
     DISPLAY "Output error." .
   END DECLARATIVES .
   DISPLAY 31A .
   PARAGRAPH-31 .
   DISPLAY 31B .
   SECTION-31 SECTION .
   DISPLAY 31C . ]

+[ PROCEDURE DIVISION .
   DISPLAY 32A .
   PARAGRAPH-32A .
   DISPLAY 32B .
   SECTION-32 SECTION .
   DISPLAY 32C .
   PARAGRAPH-32B .
   DISPLAY 32D . ]

+[ PROCEDURE DIVISION .
   DECLARATIVES .
   OUTPUT-ERROR SECTION .
     USE AFTER ERROR PROCEDURE ON OUTPUT .
   REPORT-ERROR .
     DISPLAY "Output error." .
   END DECLARATIVES .
   DISPLAY 33A .
   PARAGRAPH-33A .
   DISPLAY 33B .
   SECTION-33 SECTION .
   DISPLAY 33C .
   PARAGRAPH-33B .
   DISPLAY 33D . ]

# From The OpenCOBOL Programmer's Guide, 06FEB2009, p.7-7:

+[ PROCEDURE DIVISION USING
     BY VALUE Arg1,
     BY REFERENCE Arg2,
     BY REFERENCE Arg3.
   000-Main.
     DISPLAY 'Starting cobsub.cbl'.
     DISPLAY 'Arg1=' Arg1.
     DISPLAY 'Arg2=' Arg2.
     DISPLAY 'Arg3=' Arg3.
     MOVE 'X' TO Arg1 (1:1).
     MOVE 'X' TO Arg2 (1:1).
     MOVE 987654321 TO Arg3.
     MOVE 2 TO RETURN-CODE.
     GOBACK. ]

+[ PROCEDURE DIVISION foo .
   000-Main.
     DISPLAY "Hello, world!" .
     GOBACK. ]

+[ PROCEDURE DIVISION foo USING
     BY REFERENCE ANY .
   000-Main.
     DISPLAY "Hello, world!" .
     GOBACK. ]

+[ PROCEDURE DIVISION foo USING
     BY REFERENCE bar DELIMITED .
   000-Main.
     DISPLAY "Hello, world!" .
     GOBACK. ]

+[ PROCEDURE DIVISION foo USING
     BY REFERENCE bar DELIMITED BY SIZE .
   000-Main.
     DISPLAY "Hello, world!" .
     GOBACK. ]

+[ PROCEDURE DIVISION foo USING
     BY VALUE ANY .
   000-Main.
     DISPLAY "Hello, world!" .
     GOBACK. ]

+[ PROCEDURE DIVISION foo USING
     BY VALUE bar REPEATED .
   000-Main.
     DISPLAY "Hello, world!" .
     GOBACK. ]

+[ PROCEDURE DIVISION foo USING
     BY VALUE bar REPEATED 1 TO 10 .
   000-Main.
     DISPLAY "Hello, world!" .
     GOBACK. ]

+[ PROCEDURE DIVISION foo USING
     BY VALUE bar REPEATED 1 TO 10
     GIVING baz .
   000-Main.
     DISPLAY "Hello, world!" .
     GOBACK. ]

+[ PROCEDURE DIVISION foo USING
     BY VALUE bar REPEATED 1 TO 10
     RETURNING baz .
   000-Main.
     DISPLAY "Hello, world!" .
     GOBACK. ]

+[ PROCEDURE DIVISION foo USING
     BY OUTPUT .
   000-Main.
     DISPLAY "Hello, world!" .
     GOBACK. ]

+[ PROCEDURE DIVISION foo USING
     BY OUTPUT foo AS bar.
   000-Main.
     DISPLAY "Hello, world!" .
     GOBACK. ]

# PROCEDURE DIVISION header is never optional:

-[ DECLARATIVES .
   OUTPUT-ERROR SECTION .
     USE AFTER ERROR PROCEDURE ON OUTPUT .
   REPORT-ERROR .
     DISPLAY "Output error." .
   END DECLARATIVES .
   DISPLAY 33A .
   PARAGRAPH-33A .
   DISPLAY 33B .
   SECTION-33 SECTION .
   DISPLAY 33C .
   PARAGRAPH-33B .
   DISPLAY 33D . ]

-[ 000-Main.
     DISPLAY 'Starting cobsub.cbl'.
     DISPLAY 'Arg1=' Arg1.
     DISPLAY 'Arg2=' Arg2.
     DISPLAY 'Arg3=' Arg3.
     MOVE 'X' TO Arg1 (1:1).
     MOVE 'X' TO Arg2 (1:1).
     MOVE 987654321 TO Arg3.
     MOVE 2 TO RETURN-CODE.
     GOBACK. ]